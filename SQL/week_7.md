# 6-1. INTRO
# 6-2. 가독성을 챙기기 위하 SQL스타일 가이드

### 실수는 언제 발생하는가?
1. 문법을 잘못 알고 있는 경우
    - 문법을 공부하자

2. 데이터를 파악하지 않고 뭐리를 작성하는 경우
    - 데이터에 대한 메타정보, 컬럼의 정보(VALUE)를 잘 파악해야함.

3. 쿼리가 복잡한 경우
    - 나누기, 쪼개기 등을 통해 쿼리 단순화하기

---

👾 **쿼리를 변경해야 할 경우에 특정 부분만 바뀌었는지, 전체를 바꿨는지도 파악하는 것이 쉬우면 좋다.** 👾

: 기존의 것과 새로운 것을 비교하는 'DIFF를 뜬다'라는 것을 할 때 변경점 포인트를 알아채기 쉬우면 좋음. 

### SQL 스타일 가이드

SQL스타일 가이드에 대한 이야기를 미리 나누어볼 것. 

조직/사람마다의 작성하는 방식이 다름! 

**[권장사항]**
1. **예약어는 대문자로 작성**

    EX) SELECT, FROM, WHERE, 각종 함수

2. **컬럼이름은 snake_case로 작성**
    - python - snake_case
    - java   - CamelCase

3. **명시적인 이름**

    JOIN할 때 테이블의 이름을 명시적으로 설정할 수 있다면 명시적으로 진행

     Alias로 별칭지을때는 명시적인 이름을 적용

     ex) ~ AS a (x) // ~ AS pokemon_cnt(o)

4. **예약어나 컬럼은 한 줄에 하나씩 권장**

    컬럼은 바로 주석처리할 수 있는 장점이 있으므로, 한 줄에 하나씩 작성

```
SELECT
    col1,
    col2,
    col3,
FROM table
WHERE ~
```

5. **쉼표는 컬럼 바로 뒤에**

![alt text](<../image/7주차/쉼표의 위치.png>)

# 6-3. 가독성을 챙기기 위한 WITH문 & 파티션

## WITH문

- 쿼리의 결과를 다른 FROM절에서 재사용해야할 경우가 있음

- 반복을 최소화 하기 위해서 => WITH문 사용

### WTIH구문 사용 방법

![alt text](<../image/7주차/WITH구문 사용방법.png>)

```
추천하는 with문 사용방법

WITH base AS (   #처음에는 완전 베이스가 되는 테이블을 형성
SELECT
    col
FROM table
), 명시적 AS (    # 그 후에 계속 활용할 테이블 이름을 명시적으로 형성
SELECT
    col
FROM table
)

SELECT
FROM
WHERE~
```

## PARTITION

table엔 partition이란 것이 존재할 수 있음.

ex) 특정시기에 들어온 물건을 찾고 싶을 때, table의 partition이 존재하면 그 부분만 탐색하면 됨 (탐색하는 것도 비용이 많이 듦)

- 쿼리 성능 향상 + 비용 절감
    전체 데이터를 스캔하는 것보다 설정한 곳만 스캔하는 것이 더 빠름 & 비용 절감가능

- 데이터 관리 용이성
    특정 일자의 데이터를 모두 변경하거나 삭제해야하는 경우, 파티션이 있따면 쉽게 설정하거나 삭제할 수 있음. 